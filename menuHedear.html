<header class="large" id="menuHeader" role="banner">
  <div class="wi">
    <!-- لوگو -->
    <div id="logo" class="clearfix">
      <h1 style="margin:0">
        <a class="top_logo" href="index.html" title="Contact us">
          <img alt="Contact us" src="uploadfile/userimg/New.png" />
        </a>
      </h1>
    </div>

    <!-- Hamburger Icon -->
    <button class="hamburger" aria-label="Toggle menu" aria-controls="mainNav" aria-expanded="false">☰</button>
  </div>

  <!-- منو -->
  <div class="header_m clearfix">
    <div class="head-right clearfix">
      <div class="mainmenu-area bg-color-2">
        <div class="mainmenu">
          <nav id="mainNav" aria-label="Primary">
            <ul>
              <li><a href="index.html">Home</a></li>
              <li>
                <a href="products.html">Products</a>
                <ul class="vmegamenu">
                  <li><a href="Handheld_LIBS.html">Handheld LIBS</a></li>
                  <li><a href="Online_LIBS_Analyzer.html">Online LIBS Analyzer</a></li>
                  <li><a href="In_Situ_LIBS_Scanner.html">In Situ LIBS Scanner</a></li>
                  <li><a href="Desktop_LIBS_Analyzer.html">Desktop LIBS Analyzer</a></li>
                </ul>
              </li>
              <li>
                <a href="application_nc2.html">Application</a>
                <ul class="vmegamenu">
                  <li><a href="metals.html">Metals</a></li>
                  <li><a href="mining_n20.html">Mining</a></li>
                  <li><a href="cement_n35.html">Cement</a></li>
                  <li><a href="Environmental.html">Environmental</a></li>
                  <li><a href="Industry.html">Industry</a></li>
                  <li><a href="Biomedical.html">Biomedical</a></li>
                </ul>
              </li>
              <li>
                <a href="solutions_nc3.html">Solutions</a>
                <ul class="vmegamenu">
                  <li><a href="metals-low-alloy-steels_n3.html">Alloy Steels</a></li>
                  <li><a href="Coal">Coal</a></li>
                </ul>
              </li>
              <li><a href="contact-us_d2.html">Contact us</a></li>
            </ul>
          </nav>
        </div>
      </div>
    </div>
  </div>

  <style>
    :root{
      --hdr-bg-1:#001B2A;  /* رنگ اصلی */
      --hdr-bg-2:#001B2A;  /* می‌تونی گرادیانت بسازی، فعلاً هردو هم‌رنگ */
      --hdr-edge:#1c1c1c;
      --accent:#FF6800;
      --text:#EAF2F8;
      --header-h: 80px;    /* fallback؛ با JS دقیق میشه */
    }

    /* هدر همیشه بالاست */
    #menuHeader{
      position:fixed; top:0; left:0; right:0;
      z-index: 997; /* زیر overlay(998) و drawer(999) */
      background: linear-gradient(90deg, var(--hdr-bg-1) 0%, var(--hdr-bg-2) 90%, var(--hdr-edge) 100%);
      color: var(--text);
    }
 
    /* ردیف بالا */
    #menuHeader > .wi{ padding:10px 30px; }
    #logo img{ max-height:70px; }

    /* منوی دسکتاپ */
    .mainmenu nav ul{
      display:flex; gap:20px; list-style:none; margin:0; padding:0;
    }
    .mainmenu nav a{
      color: var(--accent);
      text-decoration:none; font-weight:500;
    }
    .mainmenu nav li{ position:relative; }
    .vmegamenu{
      display:none; position:absolute; background:#001B2A;
      padding:10px; list-style:none; min-width:180px; z-index:100;
    }
    .mainmenu nav li:hover > .vmegamenu{ display:block; }
    .vmegamenu a{ color:#fff; display:block; padding:6px 8px; }

    /* همبرگری */
    .hamburger{
      display:none; font-size:28px; color: var(--accent);
      background:transparent; border:0; cursor:pointer; line-height:1;
    }

    /* موبایل/تبلت: منو جمع می‌شود و با همبرگری باز می‌گردد */
    @media (max-width: 992px){
      #menuHeader > .wi{ padding:10px 20px; }
      .hamburger{ display:block; }
      .mainmenu nav{ display:none; }
      .mainmenu.open nav{
        display:block; background:#001B2A; width:100%; padding:10px 0;
      }
      .wi{
align-items:center; display:flex; justify-content:space-between
      }
      .mainmenu.open nav ul{
        flex-direction:column; align-items:flex-start; gap:10px;
      }
      #logo img{ max-height: 56px; }
      /* زیرمنو در موبایل با hover قابل اتکا نیست؛ ساده نمایش بده */
      .mainmenu.open .vmegamenu{ position:static; display:none; padding:6px 0 6px 16px; }
      .mainmenu.open li > a + .vmegamenu{ display:none; }
      .mainmenu.open li.open > a + .vmegamenu{ display:block; }
    }

    /* افکت هنگام اسکرول (سایه) */
    #menuHeader.is-scrolled{ box-shadow: 0 8px 20px rgba(0,0,0,.25); }

    /* دسترسی‌پذیری */
    .mainmenu a:focus-visible, .hamburger:focus-visible{
      outline:2px solid var(--accent); outline-offset:2px;
    }
  </style>

  <script>
    (function(){
      const header = document.getElementById('menuHeader');
      const hamburger = header.querySelector('.hamburger');
      const menuWrap  = header.querySelector('.mainmenu');

      // 1) فاصله‌ی بدنه به‌اندازه‌ی ارتفاع واقعی هدر
      function syncHeaderHeight(){
        const h = header.getBoundingClientRect().height;
        document.documentElement.style.setProperty('--header-h', h + 'px');
      }
      window.addEventListener('load', syncHeaderHeight);
      window.addEventListener('resize', syncHeaderHeight);
      // اگر فونت/تصویر لوگو لود شد
      if (document.fonts && document.fonts.ready) document.fonts.ready.then(syncHeaderHeight);

      // 2) سایه هنگام اسکرول
      window.addEventListener('scroll', () => {
        header.classList.toggle('is-scrolled', window.scrollY > 10);
      });

      // 3) باز/بستن منوی موبایل
      if (hamburger && menuWrap){
        hamburger.addEventListener('click', (e) => {
          e.preventDefault(); e.stopPropagation();
          const open = menuWrap.classList.toggle('open');
          hamburger.setAttribute('aria-expanded', String(open));
        });

        // بستن با کلیک بیرون
        document.addEventListener('click', (e) => {
          if (!menuWrap.classList.contains('open')) return;
          const clickedInside = menuWrap.contains(e.target) || hamburger.contains(e.target);
          if (!clickedInside){
            menuWrap.classList.remove('open');
            hamburger.setAttribute('aria-expanded','false');
          }
        });

        // بستن با Esc
        window.addEventListener('keydown', (e) => {
          if (e.key === 'Escape' && menuWrap.classList.contains('open')){
            menuWrap.classList.remove('open');
            hamburger.setAttribute('aria-expanded','false');
          }
        });

        // باز/بستن زیرمنوها در موبایل با کلیک روی والد
        menuWrap.querySelectorAll('.mainmenu > nav > ul > li > a').forEach(a => {
          const sub = a.parentElement.querySelector('.vmegamenu');
          if (!sub) return;
          a.addEventListener('click', (ev) => {
            if (window.matchMedia('(max-width: 992px)').matches){
              ev.preventDefault();
              a.parentElement.classList.toggle('open');
            }
          });
        });
      }

      // اجرا‌ی اولیه
      syncHeaderHeight();
    })();
  </script>
</header>
